# ğŸ“ PadrÃ£o de Desenvolvimento
# PadrÃµes de Desenvolvimento - CIMFLEX

## Guia Visual

### Fluxo de uma RequisiÃ§Ã£o API

```mermaid
graph LR
A[Cliente HTTP] -->|Request| B[URLs]
B -->|Rota| C[ViewSet]
C -->|ValidaÃ§Ã£o| D[Serializer]
D -->|Dados| E[Model]
E -->|Query| F[Banco de Dados]
F -->|Dados| E
E -->|Objeto| D
D -->|JSON| C
C -->|Response| A
```

### Estrutura MVC no Django

```mermaid
graph TD
A[Model] -->|Define Dados| B[Banco de Dados]
C[View/ViewSet] -->|Usa| A
C -->|Usa| D[Serializer]
D -->|Valida/Formata| A
```

## Boas PrÃ¡ticas Visuais

| âœ… Fazer | âŒ NÃ£o Fazer |
| --- | --- |
| Usar pastas separadas para models, serializers, etc. | Colocar tudo em um Ãºnico arquivo |
| Nomear arquivos de acordo com o padrÃ£o (customer.py) | Usar nomes genÃ©ricos (model.py) |
| Documentar com docstrings em portuguÃªs | Deixar cÃ³digo sem documentaÃ§Ã£o |
| Criar factory para cada model | Criar dados de teste manualmente |
| Separar testes por categoria | Misturar diferentes tipos de teste |

## FAQ para Iniciantes

### 1\. Como comeÃ§ar um novo app?

```bash
# 1. Criar o app
poetry run python manage.py startapp nome_do_app

# 2. Criar a estrutura de pastas
mkdir nome_do_app/models nome_do_app/serializers nome_do_app/viewsets nome_do_app/tests

# 3. Criar arquivos iniciais
touch nome_do_app/models/__init__.py nome_do_app/models/nome_app.py
# ... repetir para outras pastas
```

### 2\. Como organizar os imports?

```python
# âœ… Forma correta
from .models import Customer  # Import relativo
from customers.models import Customer  # Import absoluto quando necessÃ¡rio

# âŒ Evitar
from ..models import *  # Import com asterisco
import customers.models.customer  # Import muito especÃ­fico desnecessÃ¡rio
```

### 3\. Quando usar cada tipo de teste?

* **test_serializers/**: Para validaÃ§Ãµes de dados e transformaÃ§Ãµes
* **test_viewsets/**: Para endpoints da API e fluxos HTTP
* **test_models/**: Para regras de negÃ³cio e validaÃ§Ãµes do modelo

## 1\. Estrutura de Apps

### 1.1 Um App por Tela

**DefiniÃ§Ã£o**: Cada tela principal do sistema deve ter seu prÃ³prio app Django.

**MotivaÃ§Ã£o**:

* Melhor organizaÃ§Ã£o e separaÃ§Ã£o de responsabilidades
* Facilita a manutenÃ§Ã£o e desenvolvimento paralelo
* Segue princÃ­pios do Clean Code

**Exemplo**:

```
cimflex_dj/
â”œâ”€â”€ customers/           # App para tela de Clientes
â”œâ”€â”€ representatives/     # App para tela de Representantes
â””â”€â”€ products/           # App para tela de Produtos
```

### 1.2 Estrutura Interna dos Apps

Cada app deve seguir a seguinte estrutura:

```
app_name/                           # Exemplo: customers/
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ [nome_app_singular].py     # Exemplo: customer.py
â”œâ”€â”€ serializers/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ [nome_app]_serializers.py  # Exemplo: customers_serializers.py
â”œâ”€â”€ viewsets/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ [nome_app]_viewset.py      # Exemplo: customer_viewset.py
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_serializers/
â”‚   â”‚   â””â”€â”€ test_[nome_app]_serializer.py  # Exemplo: test_customer_serializer.py
â”‚   â””â”€â”€ test_viewsets/
â”‚       â””â”€â”€ test_[nome_app]_viewset.py     # Exemplo: test_customer_viewset.py
â”œâ”€â”€ factories.py
â””â”€â”€ urls.py
```

**PadrÃ£o de Nomenclatura dos Arquivos**:

* Models: usar substantivo no singular (customer.py, representative.py)
* Serializers: nome do app + '_serializers' (customers_serializers.py)
* Viewsets: nome do app + '_viewset' (customer_viewset.py)
* Testes: prefixo 'test_' + nome do componente testado (test_customer_serializer.py)

**Responsabilidades e ConfiguraÃ§Ã£o**:

* `models/`:
  * DefiniÃ§Ãµes de modelos e lÃ³gica de dados
  * O `__init__.py` deve importar e expor os models:

    ```python
    # models/__init__.py
    from .customer import Customer
    ```
* `serializers/`:
  * SerializaÃ§Ã£o de dados e validaÃ§Ãµes
  * O `__init__.py` deve importar e expor os serializers:

    ```python
    # serializers/__init__.py
    from .customers_serializers import CustomerSerializer
    ```
* `viewsets/`:
  * LÃ³gica de API e endpoints
  * O `__init__.py` deve importar e expor os viewsets:

    ```python
    # viewsets/__init__.py
    from .customer_viewset import CustomerViewSet
    ```
* `tests/`: Testes organizados por categoria
* `factories.py`: Factories para testes
* `urls.py`: Roteamento do app

**Importante**: Cada package Python (diretÃ³rio com `__init__.py`) deve importar explicitamente seus mÃ³dulos no `__init__.py`. Isso permite que outros mÃ³dulos importem diretamente do package, mantendo o cÃ³digo mais limpo e organizado.

## 2\. PadrÃ£o de CÃ³digo

### 2.1 Docstrings e ComentÃ¡rios

**Regras**:

* Usar docstrings em portuguÃªs
* Usar """ para docstrings de mÃºltiplas linhas
* Usar # para comentÃ¡rios de linha Ãºnica

**Exemplo**:

```python
class CustomerViewSet(ModelViewSet):
    """
    ViewSet para gerenciamento de clientes.
    
    Fornece operaÃ§Ãµes CRUD bÃ¡sicas:
    - Listar clientes
    - Criar cliente
    - Atualizar cliente
    - Deletar cliente
    """
    
    # ConfiguraÃ§Ã£o do serializer
    serializer_class = CustomerSerializer
```

### 2.2 Testes

#### Factory Boy

Sempre criar factories para os models:

```python
class CustomerFactory(factory.django.DjangoModelFactory):
    class Meta:
        model = Customer

    nome = factory.Faker("name")
    email = factory.Faker("email")
```

#### Estrutura de Testes

* Separar testes por categoria (serializers, viewsets)
* Usar TestCase apropriado (APITestCase para APIs)
* Nomear mÃ©todos de teste de forma descritiva

```python
def test_customer_serializer_validation(self):
    """Testa a validaÃ§Ã£o dos campos do cliente"""
    # implementaÃ§Ã£o
```

## 3\. API e Serializers

### 3.1 Versionamento

URLs devem incluir versÃ£o:

```python
re_path('cimflex/(?P<version>(v1|v2))/', include("app.urls"))
```

### 3.2 Serializers

* Criar um serializer para cada model
* Implementar validaÃ§Ãµes necessÃ¡rias
* Usar ModelSerializer quando possÃ­vel

## 4\. Ferramentas e UtilitÃ¡rios

### 4.1 Django Extensions

Pacote instalado para auxiliar no desenvolvimento:

**Comandos Ãšteis**:

```bash
# Listar todas as URLs do projeto
poetry run python manage.py showurls

# Gerar diagrama de models
poetry run python manage.py graph_models -a -o models.png
```

### 4.2 Poetry

Gerenciador de dependÃªncias do projeto. ConfiguraÃ§Ã£o bÃ¡sica via PyCharm conforme documentaÃ§Ã£o existente.

## 5\. Boas PrÃ¡ticas

### 5.1 Imports

Organizar imports na seguinte ordem:

```python
# Biblioteca padrÃ£o
import os
from datetime import datetime

# Django e DRF
from django.db import models
from rest_framework import serializers

# Imports locais
from .models import Customer
```

### 5.2 Nomenclatura

* Apps: substantivos no plural (customers, products)
* Classes: CamelCase (CustomerSerializer)
* MÃ©todos/FunÃ§Ãµes: snake_case (get_queryset)
* URLs: kebab-case (customer-detail)

## 6\. Checklist de ImplementaÃ§Ã£o

* [ ] Estrutura de diretÃ³rios correta
* [ ] Docstrings em todos os mÃ³dulos principais
* [ ] Factories implementadas
* [ ] Testes para serializers e viewsets
* [ ] ValidaÃ§Ãµes necessÃ¡rias
* [ ] URLs versionadas